# Brocade Stack OS Detection
# Single unified module: FastIron (FCX, FWS, FLS, etc.) + ICX stackable switches
# FastIron: FCX, FWS, FLS — IronWare/FastIron OS, enterprise 1991
# ICX: 6430/6450/6610/6650/7150/7250/7450/7650/7750 — FastIron OS, enterprise 1991/1588
# Optional future: TurboIron if synergies exist (else in routing/modular project)

os: brocade-stack
text: 'FastIron / ICX Stackable Switches'
type: network
icon: brocade
group: brocade
over:
    - { graph: device_bits, text: 'Device Traffic' }
    - { graph: device_processor, text: 'CPU Usage' }
    - { graph: device_mempool, text: 'Memory Usage' }
mib_dir: brocade
discovery:
    -
        # FastIron Stackable Switches - FCX Series
        # Matches: FCX648, FCX648S, FCX648S-HPOE, FCX648S-1.0, etc.
        sysDescr:
            - 'FCX'
        sysObjectID:
            - .1.3.6.1.4.1.1991.1.3.48  # Foundry stackable FCX series
    -
        # FastIron Stackable Switches - FWS Series (Workgroup Stackable)
        # Matches: FWS648, FWS648G, etc.
        sysDescr:
            - 'FWS'
        sysObjectID:
            - .1.3.6.1.4.1.1991.1.3.48  # Foundry stackable FWS series
    -
        # FastIron Layer 2 Switches - FLS Series
        # Matches: FLS624, FLS648, FLS724, etc.
        sysDescr:
            - 'FLS'
        sysObjectID:
            - .1.3.6.1.4.1.1991.1.3.48  # Foundry stackable FLS series
    -
        # ICX Stackable Switches - 6430/6450 Series
        # Matches: ICX6430, ICX6450-24, ICX6450-48, ICX6450-24P, etc.
        sysDescr:
            - 'ICX6430'
            - 'ICX6450'
        sysObjectID:
            - .1.3.6.1.4.1.1991.1.3.48  # Foundry stackable ICX series
            - .1.3.6.1.4.1.1588.2.1.1.1.3  # Brocade ICX series
    -
        # ICX Stackable Switches - 6610/6650 Series
        # Matches: ICX6610, ICX6650, etc.
        sysDescr:
            - 'ICX6610'
            - 'ICX6650'
        sysObjectID:
            - .1.3.6.1.4.1.1991.1.3.48  # Foundry stackable ICX series
            - .1.3.6.1.4.1.1588.2.1.1.1.3  # Brocade ICX series
    -
        # ICX Stackable Switches - 7150/7250 Series
        # Matches: ICX7150, ICX7250, etc.
        sysDescr:
            - 'ICX7150'
            - 'ICX7250'
        sysObjectID:
            - .1.3.6.1.4.1.1991.1.3.48  # Foundry stackable ICX series
            - .1.3.6.1.4.1.1588.2.1.1.1.3  # Brocade ICX series
    -
        # ICX Stackable Switches - 7450/7650/7750 Series
        # Matches: ICX7450, ICX7650, ICX7750, etc.
        sysDescr:
            - 'ICX7450'
            - 'ICX7650'
            - 'ICX7750'
        sysObjectID:
            - .1.3.6.1.4.1.1991.1.3.48  # Foundry stackable ICX series
            - .1.3.6.1.4.1.1588.2.1.1.1.3  # Brocade ICX series
    -
        # Generic FastIron/IronWare matches (fallback)
        sysDescr:
            - 'FastIron'
            - 'IronWare'
        sysObjectID:
            - .1.3.6.1.4.1.1991.1.3  # Generic Foundry FastIron
            - .1.3.6.1.4.1.1991.1.3.48  # Foundry stackable
    -
        # Brocade ICX generic match
        sysDescr:
            - 'Brocade ICX'
        sysObjectID:
            - .1.3.6.1.4.1.1588.2.1.1.1.3  # Brocade ICX series

# Minimal skip conditions - only exclude obvious non-stackable routing devices
skip_values:
    -
        # Skip NetIron routing switches (clearly routing-focused)
        oid: SNMPv2-MIB::sysDescr.0
        op: '~'
        value: 'NetIron'
    -
        # Skip BigIron chassis routing switches (enterprise routing)
        oid: SNMPv2-MIB::sysDescr.0
        op: '~'
        value: 'BigIron'
    -
        # Skip TurboIron routing switches (core routing)
        oid: SNMPv2-MIB::sysDescr.0
        op: '~'
        value: 'TurboIron'
    -
        # Skip ServerIron load balancers (application delivery)
        oid: SNMPv2-MIB::sysDescr.0
        op: '~'
        value: 'ServerIron'
    #  - Brocade enterprise not needed - fabric switch OID's only
        # Brocade enterprise (ICX, newer firmware)
        # sysDescr:
        #     - FastIron
        # sysObjectID:
        #     - .1.3.6.1.4.1.1588.2.1.1.1.3

oids:
    no_bulk:
        - ifPhysAddress

register_mibs:
    - FOUNDRY-SN-ROOT-MIB
    - FOUNDRY-SN-AGENT-MIB
    - FOUNDRY-SN-SWITCH-GROUP-MIB
    - FOUNDRY-SN-STACKING-MIB

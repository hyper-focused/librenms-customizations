# Brocade Stack OS Detection
# OID-based detection for FastIron + ICX stackable switches
# Three methods: Stack mode, Standalone FastIron, Standalone ICX
# No generic fallbacks - precise family-specific coverage
---
os: brocade-stack
text: 'FastIron / ICX Stackable Switches'
type: network
icon: brocade
group: brocade
over:
    - {graph: device_bits, text: 'Device Traffic'}
    - {graph: device_processor, text: 'CPU Usage'}
    - {graph: device_mempool, text: 'Memory Usage'}
mib_dir: brocade
discovery:
    -
        # Stack mode detection
        sysObjectID: [.1.3.6.1.4.1.1991.1.3.48]
    -
        # Standalone FastIron switches (FGS, FLS, FWS, FCX)
        sysObjectID:
            - .1.3.6.1.4.1.1991.1.3.45  # FGS
            - .1.3.6.1.4.1.1991.1.3.46  # FLS
            - .1.3.6.1.4.1.1991.1.3.52  # FWS
            - .1.3.6.1.4.1.1991.1.3.54  # FCX
    -
        # Standalone ICX switches (all families)
        sysObjectID:
            - .1.3.6.1.4.1.1991.1.3.56  # ICX6610 family
            - .1.3.6.1.4.1.1991.1.3.57  # ICX6430 family
            - .1.3.6.1.4.1.1991.1.3.58  # ICX6450 family
            - .1.3.6.1.4.1.1991.1.3.59  # ICX6650 family
            - .1.3.6.1.4.1.1991.1.3.60  # ICX7750 family
            - .1.3.6.1.4.1.1991.1.3.61  # ICX7450 family
            - .1.3.6.1.4.1.1991.1.3.62  # ICX7250 family
            - .1.3.6.1.4.1.1991.1.3.64  # ICX7150 family
            - .1.3.6.1.4.1.1991.1.3.65  # ICX7650 family

# Skip non-stackable routing devices
skip_values:
    - {oid: "SNMPv2-MIB::sysDescr.0", op: "~", value: "NetIron"}
    - {oid: "SNMPv2-MIB::sysDescr.0", op: "~", value: "BigIron"}
    - {oid: "SNMPv2-MIB::sysDescr.0", op: "~", value: "TurboIron"}
    - {oid: "SNMPv2-MIB::sysDescr.0", op: "~", value: "ServerIron"}

oids:
    no_bulk:
        - ifPhysAddress

register_mibs:
    - FOUNDRY-SN-ROOT-MIB
    - FOUNDRY-SN-AGENT-MIB
    - FOUNDRY-SN-SWITCH-GROUP-MIB
    - FOUNDRY-SN-STACKING-MIB
